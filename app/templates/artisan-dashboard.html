<!doctype html>
<html lang="en-GB">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0B0F19" />

  <title>47Builders | Artisan Dashboard</title>
  <meta name="description"
    content="Artisan dashboard for project status, job search, invites, messages, location availability, and account balance." />

  <link rel="stylesheet" href="{{url_for('static', filename='css/artisan-dashboard.css')}}" />
</head>

<body>
  <a class="skipLink" href="#main">Skip to content</a>

  <header class="topbar" data-elevate>
    <div class="container topbarRow">
      <a class="brand" href="/" aria-label="47Builders Home">
        <img src="{{url_for('static', filename='images/logo47builders.png')}}" alt="47Builders logo" width="130" height="50" />
        <div class="brandText">
          <strong>47Builders</strong>
          <span class="muted">Artisan Dashboard</span>
        </div>
      </a>

      <div class="topbarRight">
        <button class="pillBtn" id="availabilityBtn" type="button" aria-live="polite">
          <span class="dot" id="availabilityDot" aria-hidden="true"></span>
          <span id="availabilityText">Location: Off</span>
        </button>

        <button class="iconBtn" id="notifBtn" type="button" aria-label="Notifications">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 22a2 2 0 0 0 2-2H10a2 2 0 0 0 2 2zm6-6V11a6 6 0 1 0-12 0v5L4 18v1h16v-1l-2-2z"></path>
          </svg>
        </button>

        <button class="userChip" id="userMenuBtn" type="button" aria-haspopup="menu" aria-expanded="false">
          <span class="avatar" aria-hidden="true">A</span>
          <span class="userMeta">
            <span class="userName" id="">{{artisan.firstName}} {{artisan.lastName}}</span>
            <span class="userRole">Verified</span>
          </span>
          <svg class="chev" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M7 10l5 5 5-5H7z"></path>
          </svg>
        </button>

        <div class="menu" id="userMenu" role="menu" aria-label="User menu" hidden>
          <button role="menuitem" type="button" id="menuProfile">Profile</button>
          <button role="menuitem" type="button" id="menuSettings">Settings</button>
          <button role="menuitem" type="button" id="menuLogout"><a href="{{url_for('logout')}}">Log out</a></button>
        </div>
      </div>
    </div>
  </header>

  <div style="display: flex; justify-content: center; margin-top: 40px;">
  {% include 'msgFlash.html' %}
</div>

  <div class="shell">
    <aside class="sidebar" aria-label="Sidebar navigation">
      <div class="sideSection">
        <div class="sideTitle">Workspace</div>

        <nav class="sideNav">
          <a href="#overview" class="active" data-view="overview">
            <span class="ico" aria-hidden="true">üèóÔ∏è</span>
            Overview
          </a>
          <a href="#jobs" data-view="jobs">
            <span class="ico" aria-hidden="true">üîé</span>
            Job Search
          </a>
          <a href="#invites" data-view="invites">
            <span class="ico" aria-hidden="true">üì©</span>
            Job Invites
            <span class="badge" id="invitesBadge">0</span>
          </a>
          <a href="#messages" data-view="messages">
            <span class="ico" aria-hidden="true">üí¨</span>
            Messages
            <span class="badge" id="messagesBadge">0</span>
          </a>
          <a href="#wallet" data-view="wallet">
            <span class="ico" aria-hidden="true">üí∞</span>
            Account Balance
          </a>
        </nav>
      </div>

      <div class="sideSection">
        <div class="sideTitle">Quick actions</div>

        <button class="sideBtn" id="btnUpdateStatus" type="button">
          Update project status
        </button>

        <button class="sideBtn" id="btnToggleLocation" type="button">
          Turn location on/off
        </button>
      </div>

      <div class="sideSection">
        <div class="sideHint">
          Tip: Keep location on when you are available for site visits and quick jobs.
        </div>
      </div>
    </aside>

    <main id="main" class="content" tabindex="-1">
      <section class="pageHead" id="overview">
        <div>
          <h1>Dashboard</h1>
          <p class="muted">Manage your jobs, invites, messages, location availability, and wallet.</p>
        </div>

        <div class="headActions">
          <button class="btn" id="refreshBtn" type="button">Refresh</button>
          <button class="btn primary" id="findJobsBtn" type="button">Find jobs</button>
        </div>
      </section>

      <section class="grid">
        <article class="card">
          <div class="cardTop">
            <h2>Current project status</h2>
            <button class="linkBtn" id="editProjectBtn" type="button">Edit</button>
          </div>

          <div class="projectBox">
            <div class="projRow">
              <div>
                <div class="label">Project</div>
                <div class="value" id="projName">Lekki Duplex Renovation</div>
              </div>
              <div>
                <div class="label">Role</div>
                <div class="value" id="projRole">Tiling and Finishing</div>
              </div>
            </div>

            <div class="projRow">
              <div>
                <div class="label">Milestone</div>
                <div class="value" id="projMilestone">Floor tiling (Phase 2)</div>
              </div>
              <div>
                <div class="label">Status</div>
                <div class="statusPill" id="projStatus">In progress</div>
              </div>
            </div>

            <div class="progWrap" aria-label="Milestone progress">
              <div class="progBar" id="projBar" style="width: 62%"></div>
            </div>

            <div class="projFoot">
              <div class="mutedSmall" id="projMeta">Due in 6 days ¬∑ Last update: today</div>
              <button class="btn small" id="postUpdateBtn" type="button">Post update</button>
            </div>
          </div>
        </article>

        <article class="card">
          <div class="cardTop">
            <h2>Account balance</h2>
            <button class="linkBtn" id="withdrawBtn" type="button">Withdraw</button>
          </div>

          <div class="walletBox">
            <div class="walletMain">
              <div class="walletAmt" id="walletBalance">‚Ç¶250,000</div>
              <div class="mutedSmall">Available balance</div>
            </div>

            <div class="walletGrid">
              <div class="mini">
                <div class="label">Pending</div>
                <div class="value" id="walletPending">‚Ç¶90,000</div>
              </div>
              <div class="mini">
                <div class="label">This month</div>
                <div class="value" id="walletMonth">‚Ç¶410,000</div>
              </div>
            </div>

            <button class="btn primary" id="viewWalletBtn" type="button">View wallet</button>
          </div>
        </article>

        <article class="card">
          <div class="cardTop">
            <h2>Job search</h2>
            <button class="linkBtn" id="saveFiltersBtn" type="button">Save filters</button>
          </div>

          <form class="filters" id="jobSearchForm">
            <label class="field">
              Skill
              <select name="skill" id="skillSelect">
                <option value="all">All</option>
                <option value="masonry">Masonry</option>
                <option value="tiling" selected>Tiling</option>
                <option value="carpentry">Carpentry</option>
                <option value="plumbing">Plumbing</option>
                <option value="electrical">Electrical</option>
                <option value="painting">Painting</option>
              </select>
            </label>

            <label class="field">
              City
              <select name="city" id="citySelect">
                <option value="lagos" selected>Lagos</option>
                <option value="benin">Benin City</option>
                <option value="ph">Port Harcourt</option>
              </select>
            </label>

            <label class="field">
              Budget
              <select name="budget" id="budgetSelect">
                <option value="all">Any</option>
                <option value="low">‚Ç¶50k to ‚Ç¶150k</option>
                <option value="mid" selected>‚Ç¶150k to ‚Ç¶500k</option>
                <option value="high">‚Ç¶500k+</option>
              </select>
            </label>

            <button class="btn primary" type="submit">Search jobs</button>
          </form>

          <div class="list" id="jobsList" aria-label="Search results"></div>
        </article>

        <article class="card">
          <div class="cardTop">
            <h2>Job invites</h2>
            <button class="linkBtn" id="markInvitesReadBtn" type="button">Mark all read</button>
          </div>

          <div class="list" id="invitesList" aria-label="Invites list"></div>
        </article>

        <article class="card full">
          <div class="cardTop">
            <h2>Messages</h2>
            <div class="cardTopRight">
              <input class="search" id="messageSearch" type="search" placeholder="Search messages"
                aria-label="Search messages" />
              <button class="btn small" id="newMsgBtn" type="button">New message</button>
            </div>
          </div>

          <div class="messages">
            <div class="threads" id="threads" aria-label="Conversation threads"></div>

            <div class="chat">
              <div class="chatHead">
                <div>
                  <div class="label">Chat</div>
                  <div class="value" id="chatTitle">Select a conversation</div>
                </div>
                <button class="btn small" id="openJobBtn" type="button" disabled>Open job</button>
              </div>

              <div class="chatBody" id="chatBody" aria-label="Chat messages"></div>

              <form class="chatComposer" id="chatForm">
                <input id="chatInput" type="text" placeholder="Type a message‚Ä¶" autocomplete="off" />
                <button class="btn primary" type="submit" id="sendBtn" disabled>Send</button>
              </form>
            </div>
          </div>
        </article>
      </section>
    </main>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true" hidden></div>

  <dialog class="modal" id="statusModal" aria-label="Update project status">
    <form method="dialog" class="modalCard" id="statusForm">
      <div class="modalHead">
        <strong>Update project status</strong>
        <button class="iconBtn" type="button" id="closeStatusModal" aria-label="Close">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <label class="field">
        Status
        <select name="status" id="statusSelect">
          <option>Not started</option>
          <option selected>In progress</option>
          <option>Blocked</option>
          <option>Completed</option>
        </select>
      </label>

      <label class="field">
        Progress (%)
        <input name="progress" id="progressInput" type="number" min="0" max="100" value="62" />
      </label>

      <label class="field">
        Update note
        <textarea name="note" id="noteInput" rows="4" placeholder="What changed since the last update?"></textarea>
      </label>

      <div class="modalActions">
        <button class="btn" type="button" id="cancelStatus">Cancel</button>
        <button class="btn primary" value="confirm">Save update</button>
      </div>
    </form>
  </dialog>

  <script src="{{url_for('static', filename='js/artisan-dashboard.js')}}" defer></script>

</body>

</html>